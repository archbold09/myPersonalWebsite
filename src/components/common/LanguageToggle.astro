---
// Language toggle button component
---

<button
  id="language-toggle"
  class="px-3 py-1.5 rounded-xl hover:bg-slate-100 dark:hover:bg-white/10 transition-all duration-300 flex items-center gap-2 text-sm font-medium text-slate-700 dark:text-slate-300"
  aria-label="Toggle language"
  title="Toggle English/Spanish"
>
  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129" />
  </svg>
  <span id="current-lang">ES</span>
</button>

<script>
  const langToggle = document.getElementById('language-toggle');
  const currentLangSpan = document.getElementById('current-lang');

  // Get saved language or default to Spanish
  function getSavedLanguage(): 'es' | 'en' {
    if (typeof localStorage !== 'undefined') {
      return (localStorage.getItem('language') as 'es' | 'en') || 'es';
    }
    return 'es';
  }

  // Apply language
  function applyLanguage(lang: 'es' | 'en') {
    document.documentElement.setAttribute('data-lang', lang);
    if (currentLangSpan) {
      currentLangSpan.textContent = lang.toUpperCase();
    }

    // Dispatch custom event for components to listen
    window.dispatchEvent(new CustomEvent('language-change', { detail: { language: lang } }));
  }

  // Initialize
  const savedLang = getSavedLanguage();
  applyLanguage(savedLang);

  langToggle?.addEventListener('click', () => {
    const currentLang = document.documentElement.getAttribute('data-lang') as 'es' | 'en' || 'es';
    const newLang = currentLang === 'es' ? 'en' : 'es';

    localStorage.setItem('language', newLang);
    applyLanguage(newLang);
  });
</script>
