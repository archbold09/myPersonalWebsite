---
import { skills, skillCategories, getSkillsByCategory } from '../../data/skills';
import type { Skill } from '../../types';
---

<div class="space-y-12">
  {skillCategories.map((category) => {
    const categorySkills = getSkillsByCategory(category.id as Skill['category']);
    if (categorySkills.length === 0) return null;

    return (
      <div>
        <h3 class="text-xl font-semibold mb-6 text-center text-slate-900 dark:text-white">
          <span class="lang-es">{category.labelEs}</span>
          <span class="lang-en hidden">{category.labelEn}</span>
        </h3>

        <div class="flex flex-wrap justify-center gap-4">
          {categorySkills.map((skill) => (
            <div
              class="glass p-4 card-hover group w-20 h-20 flex items-center justify-center rounded-xl transition-all duration-300"
              style={`border-color: ${skill.color}40;`}
              title={skill.name}
            >
              <div class="flex flex-col items-center">
                <div
                  class="w-12 h-12 rounded-lg flex items-center justify-center transition-transform group-hover:scale-110"
                  style={`background: linear-gradient(135deg, ${skill.color}20, ${skill.color}10); border: 1px solid ${skill.color}30;`}
                >
                  <span class="text-xl font-bold" style={`color: ${skill.color};`}>
                    {skill.name.substring(0, 2).toUpperCase()}
                  </span>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    );
  })}
</div>

<script>
  // Language switching for skills
  function updateSkillsLanguage(lang: 'es' | 'en') {
    const skillsSection = document.getElementById('skills');
    if (!skillsSection) return;

    skillsSection.querySelectorAll('.lang-es').forEach(el => {
      el.classList.toggle('hidden', lang !== 'es');
    });
    skillsSection.querySelectorAll('.lang-en').forEach(el => {
      el.classList.toggle('hidden', lang !== 'en');
    });
  }

  window.addEventListener('language-change', ((e: CustomEvent) => {
    updateSkillsLanguage(e.detail.language);
  }) as EventListener);

  const savedLang = localStorage.getItem('language') as 'es' | 'en' || 'es';
  updateSkillsLanguage(savedLang);
</script>
